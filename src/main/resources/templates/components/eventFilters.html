
<div th:fragment="filterForm">
  <form method="get" th:action="@{/}" style="display: inline;">

     <button type="submit"
                    name="categoryId"
                    value=""
                    th:classappend="${selectedCategoryId == null} ? 'btn-dark' : 'btn-outline-dark'"
                    class="btn">
                All
            </button>
    
    <!-- Preserve search query when clicking "All" -->
    <input type="hidden" name="search" th:value="${searchQuery}" th:if="${searchQuery != null && !searchQuery.isEmpty()}" />
  </form>

 <form 
    th:each="category : ${categories}" 
    method="get" 
    th:action="@{/}" 
    style="display: inline;"
  >
    <!-- Hidden fields -->
    <input type="hidden" name="categoryId" th:value="${category.categoryId}" />
    <input type="hidden" name="search" 
           th:value="${searchQuery}" 
           th:if="${searchQuery != null and !searchQuery.isEmpty()}" />

    <!-- Category button -->
    <button 
      type="submit" 
      class="btn"
      th:classappend="${selectedCategoryId != null and selectedCategoryId.equals(category.categoryId)} ? 'btn-dark' : 'btn-outline-dark'"
      th:text="${category.name}"
    >
      Category
    </button>
  </form>
</div>